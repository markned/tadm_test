# Quiz Application - Модульная архитектура

Приложение для прохождения тестов с модульной архитектурой, динамической загрузкой тестов и сохранением результатов.

## Быстрый старт

1. Запустите локальный HTTP сервер:
   ```bash
   # Windows (PowerShell)
   python -m http.server 8000
   
   # Или используйте готовый скрипт
   start-server-simple.bat
   ```

2. Откройте в браузере: `http://localhost:8000/index.html`

## Структура проекта

```
├── index.html              # Главное приложение (React компонент)
├── index_backup.html       # Backup оригинальной версии (в .gitignore)
├── .gitignore             # Игнорируемые файлы
├── TESTS/                 # Папка с тестами
│   ├── tests.json         # Список доступных тестов
│   ├── C_TADM_23/        # Тест 1
│   │   ├── config.json
│   │   └── quiz-data.json
│   └── E_S4CON_2505/     # Тест 2
│       ├── config.json
│       └── quiz-data.json
└── js/                    # JavaScript модули
    ├── services/          # Сервисы
    │   ├── testLoader-global.js      # Загрузка тестов
    │   ├── questionService-global.js  # Работа с вопросами
    │   └── resultsDB-global.js        # База данных результатов (IndexedDB)
    ├── components/        # React компоненты
    │   └── TestSelector-global.js     # Выбор теста
    └── modules-init.js    # Инициализация модулей
```

## Основные функции

### Режимы работы

**Study Mode:**
- Мгновенная обратная связь по ответам
- Доступны подсказки
- Повтор неправильных вопросов до правильного ответа
- Доступ к Knowledge Base
- Результаты не сохраняются в базу данных

**Exam Mode:**
- Нет мгновенной обратной связи
- Нет подсказок
- Нет повтора вопросов
- Доступен таймер
- Результаты сохраняются в базу данных
- Knowledge Base отключена
- Проверка неотвеченных вопросов перед завершением

### Динамическая загрузка тестов
- Автоматическое обнаружение тестов в папке `TESTS/`
- Загрузка конфигурации и данных из JSON файлов
- Выбор теста через dropdown в header
- Автоматическое обновление списка при добавлении новых тестов

### База данных результатов
- Сохранение результатов в IndexedDB (только в Exam Mode)
- История попыток с фильтрацией по username, test ID и дате
- Детальная статистика по категориям
- Сохранение неправильных ответов с вариантами для анализа
- Просмотр истории через кнопку "History" в header

### Пользовательский интерфейс
- Компактный sidebar с номерами вопросов (миниатюрный вид)
- Username в footer справа
- Tooltips для режимов Study/Exam и выбора размера теста
- Адаптивный дизайн для мобильных устройств
- Горизонтальная навигация по вопросам на мобильных

## Как использовать

### Первый запуск

1. При первом открытии приложения появится модальное окно для ввода username
2. Username сохраняется в localStorage и используется для всех Exam Mode попыток
3. Выберите тест из dropdown в header
4. Выберите режим (Study/Exam) и размер теста (Set)
5. Начните прохождение теста

### Добавление нового теста

1. Создайте папку в `TESTS/` с ID теста (например, `NEW_TEST_001`)
2. Добавьте `config.json` с конфигурацией теста
3. Добавьте `quiz-data.json` с вопросами
4. Обновите `TESTS/tests.json`, добавив новый тест в список
5. Приложение автоматически обнаружит новый тест

### Структура config.json

```json
{
  "testId": "NEW_TEST_001",
  "testName": "Название теста",
  "quizSizes": [5, 20, 40, 80, 275],
  "defaultQuizSize": 80,
  "passThreshold": 65,
  "hintMs": 50,
  "autoNextDelayMs": 2000,
  "timePerQuestionSec": 135,
  "topicDistribution": {
    "Category1": 30,
    "Category2": 40,
    "Category3": 30
  },
  "categoryDisplayNames": {
    "Category1": "Category 1 Display Name",
    "Category2": "Category 2 Display Name",
    "Category3": "Category 3 Display Name"
  }
}
```

### Структура quiz-data.json

```json
[
  {
    "id": "Q1",
    "question": "Текст вопроса?",
    "options": [
      "Вариант 1",
      "Вариант 2",
      "Вариант 3",
      "Вариант 4"
    ],
    "correctAnswerIndex": [0],
    "type": "single",
    "explanation": "Объяснение правильного ответа",
    "category": "Category1"
  }
]
```

## Технические детали

- **React 18** через CDN
- **Tailwind CSS** для стилей
- **Babel Standalone** для JSX трансформации
- **IndexedDB** для хранения результатов
- **ES6 модули** (адаптированы для работы через window объект)
- **LocalStorage** для хранения username и настроек

## Особенности реализации

### Модульная архитектура
- Все сервисы вынесены в отдельные модули (`*-global.js`)
- Модули экспортируют функционал через `window.QuizApp`
- Легкое добавление новых функций и тестов
- Простое обслуживание и отладка

### Кэширование
- Реализован cache-busting для динамически загружаемых JSON файлов
- Автоматическое обновление данных при изменении конфигурации

### Безопасность
- Проверка на неотвеченные вопросы в Exam Mode перед завершением
- Предупреждение при смене теста во время активной попытки
- Валидация данных при загрузке тестов

## Файлы в .gitignore

- `index_backup.html` - backup файл
- `start-server-simple.bat`, `start-server.bat`, `start-server.ps1` - локальные скрипты запуска сервера

## История изменений

### Последние обновления
- Добавлены компактные tooltips для режимов Study/Exam
- Username перенесен в footer
- Удален счетчик "Q 1 / 5"
- Добавлена проверка неотвеченных вопросов в Exam Mode
- Улучшена история результатов с отображением вариантов ответов
- Добавлен sticky header в модальном окне неправильных ответов
- Оптимизирована проверка выбора теста (не обновляет, если выбран тот же)
